<!DOCTYPE html>
<html>
<head>
    <title>Multi-Doctor Live Tracker</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>#map { height: 100vh; width: 100vw; }</style>
</head>
<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
const map = L.map('map').setView([20.5937, 78.9629], 5);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

const socket = io();
let markers = {};
let colors = ["red","blue","green","orange","purple","yellow","pink","cyan","brown","black"];

socket.on('locations_update', (locations) => {
    let i = 0;
    for (let doctor_id in locations) {
        let {lat, lon} = locations[doctor_id];
        if (markers[doctor_id]) {
            markers[doctor_id].setLatLng([lat, lon]);
        } else {
            let color = colors[i % colors.length];
            markers[doctor_id] = L.circleMarker([lat, lon], {radius: 10, color: color})
                .addTo(map)
                .bindPopup(`Doctor ID: ${doctor_id}`);
            i++;
        }
    }
});
</script>
</body>
</html>
